## 项目指令：请作为首席全栈架构师与开发者，协助我构建一个代号为“WordMate”（词友）的下一代AI单词学习应用。

一、 项目核心愿景
开发一个将单词拟人化为AI好友的移动应用。核心创新在于：模拟微信的社交体验，让每个单词像一个拥有性格的好友，根据个性化艾宾浩斯遗忘曲线主动给用户发复习消息。学习过程是一场与AI好友的对话、游戏和挑战，而非传统背诵。

二、 详细功能需求
1. 拟人化AI单词好友系统 (核心)
首次添加：用户添加单词后，该“单词好友”立即在聊天列表发送第一条AI生成的、拟人化的自我介绍。内容需结构化包含：单词在四六级/考研的出现频率、核心词义、词根词缀记忆法、标准发音。

智能复习提醒：系统根据后台计算的个人化艾宾浩斯记忆曲线，在最佳时间点（如第1、2、4、7、15天…）触发“单词好友”主动向用户“首页”发送一条复习消息。消息形式需多样化（如选择题、近义词辨析、包含该单词的近期新闻句子）。

沉浸式私聊窗口：

进入门槛：用户点击单词进入前，必须通过 “声纹验证”：① App播放单词发音；② 用户跟读，系统评估相似度需≥70%。③ 通过后，进行自觉测试（用户自评是否掌握，选“否”则单词好友会重新介绍）。

AI对话：在聊天窗口内，用户可与“单词好友”自由对话，例如询问记忆技巧、请求造句、辨析近义词。AI回复需生动、个性化，旨在帮助记忆。

交互功能：聊天窗口右上角菜单，提供“加入白名单”选项。

2. 微信式首页与交互
首页（消息列表）：每个单词显示为一个聊天项。用户可对列表项进行 “左滑（打叉-忘记）” 或 “右滑（打勾-记住）” 操作。“打勾”后，该项目暂时从首页消失，进入下一复习周期。

联系人页：类似微信通讯录，按字母顺序展示所有已添加的“单词好友”。

3. 白名单系统 (深度记忆模块)
这是一个独立的底部导航页（与首页、联系人、我的并列）。

用于存放用户标记的最难单词，提供强化训练：

多维测试：提供听力选义、完形填空、中英互译等高级题型。

记忆工坊：允许用户为该单词关联图片、自创口诀或录制解说。

成就追踪：可视化展示征服该单词的历程和掌握度勋章。

4. 其他关键功能
触控书写：在单词复习或测试环节，可开启手写板进行默写，笔迹可保存。

分层商业化：代码架构需支持 “基础版（免费，功能受限）”、“高级版（解锁AI功能）”、“旗舰版（高级AI模型+人工服务）” 的权限控制。

三、 技术栈与开发要求
技术选型：

前端：使用 Flutter 以实现高效的跨平台（iOS/Android）开发，并支持流畅的自定义手势（滑卡）和动画。

后端：使用 Python (FastAPI) 构建RESTful API，用于处理用户数据、复习调度和集成AI服务。

数据库：使用 PostgreSQL 存储核心关系数据（用户、单词、复习记录）；使用 Redis 缓存会话和热门数据。

AI服务集成（所有ai用api进行调用我可以给你）：

调用大语言模型API（如openrouter 的deepseek和智谱的glm4.7）生成所有拟人化对话和内容。请设计高效的Prompt工程模板。

集成语音服务：TTS（文本转语音）用于发音，ASR（语音识别）用于跟读，并开发简单的声纹比对逻辑。

对象存储：使用 AWS S3 或 MinIO 存储用户生成的语音、手写图片等文件。

开发优先级 (分阶段)：

第一阶段 (MVP - 核心闭环)：实现单词添加、首页滑卡交互、基础复习队列、简单的单词详情页。请优先给出此阶段的数据库Schema设计和核心API接口列表。

第二阶段 (AI集成)：集成LLM API实现单词自我介绍和简单对话；集成基础语音功能（播放、录制、相似度逻辑）。

第三阶段 (功能完善)：开发完整的白名单页面、手写功能、商业化权限系统。

四、 请你执行的第一步
请根据以上需求，为我规划并生成以下内容：

系统架构图：绘制一个清晰的、模块化的前后端架构框图，展示各组件如何交互。

核心数据库表结构设计：详细列出users、word_friends、review_schedules、chat_messages等关键表的字段、类型和关联关系。

MVP阶段的核心API端点设计：列出实现第一阶段闭环（添加单词、首页列表、滑卡操作）所必需的REST API端点，包括URL、方法、请求/响应示例。

第一个技术难点攻关方案：针对 “动态生成拟人化单词自我介绍” 这一功能，设计一个具体的、可实现的 LLM Prompt 模板，确保生成内容包含我们要求的全部结构化信息，且风格友好有趣。



## WordMate 应用详细交互与页面需求文档
A. 全局通用交互与组件
底部导航栏：始终显示（除全屏书写等特殊页面）。

图标1：首页 (消息列表) - 带未读小红点（数字为所有待复习单词总数）

图标2：联系人 (单词库) - 无状态

图标3：白名单 (挚友殿堂) - 无状态

图标4：我的 (个人中心) - 无状态

全局滑动手势：

在首页列表项上：

向右轻滑：露出绿色对勾图标和“记住了”文字。松开手，对该单词执行“打勾”操作，单词从首页列表暂时消失，等待下次复习。

向左轻滑：露出红色叉号图标和“忘记了”文字。松开手，执行“打叉”操作，该单词的“好友”会立即在聊天中发送一条强化复习消息，且该单词在首页的排序提前。

在手写板页面：自由书写，无特定手势。

B. 页面级详细说明
页面一：启动与语音验证页

场景：从首页或联系人点击任一单词好友后进入。

布局与功能：

顶部栏：显示单词文本（如“Ambiguous”）和音标（如 /æmˈbɪɡjuəs/）。右侧有一个小喇叭按钮，点击可重复播放单词标准发音。
核心区域：
波形图：显示标准发音（上方）和用户跟读录音（下方）的声波对比，视觉化反馈相似度。
大圆形录音按钮：中央显示“点击跟读”。用户长按按钮开始录音，松开结束。录音时按钮变为红色并有脉冲动画。
结果反馈区：
录音结束后，系统立即分析。若相似度<70%，显示“发音可以更准确哦，再试一次吧！”（红色文字），并自动回放标准发音，用户可再次尝试。
若相似度>=70%，显示“发音很棒！”（绿色文字），并自动进入下一步。
自觉测试弹窗：
语音通过后，全屏弹出一个半透明模态窗口。
文案：“你确认已经掌握‘Ambiguous’的主要意思了吗？”
按钮：
绿色按钮【是的，我掌握了】：直接进入与该单词的私聊主页面。
红色按钮【不，再教我一次】：窗口关闭，直接进入一个单词详情介绍页（非聊天形式），用图文并茂的方式重新介绍该单词。该页底部有一个巨大的【进入聊天】按钮，点击后进入私聊主页面。
页面二：首页（消息列表）

布局：类似微信聊天列表。

列表项构成（每一行）：

左侧：
头像：圆形背景，内部显示单词首字母的艺术字（如“A”），背景色根据单词难度或词性生成。
未读红点：若有待复习消息，头像右上角显示红色数字角标（如“2”）。
中间：
主标题（昵称）：单词本身（如“Ambiguous”）。
副标题（最后一条消息预览）：显示该单词好友发来的最新一条消息的前缀，例如：“你分得清我和‘vague’的区别吗...”
右侧：
时间戳：显示最后一条消息的时间（如“10:30”或“昨天”）。
交互：

点击列表项：进入启动与语音验证页（见上文）。

左滑/右滑列表项：执行“打叉/打勾”全局操作（见上文）。

页面三：单词私聊主页面

布局：标准聊天界面，上方为对话区域，下方为输入栏。

顶部导航栏：

左侧：返回箭头 + 单词文本及音标。

中间：显示“已掌握度：65%”或勋章图标（动态进度）。

右侧：更多功能菜单（三点图标）。点击弹出操作列表：

加入白名单/移出白名单：切换选项。
查看单词档案：跳转到静态的单词详情介绍页。
记忆挑战：针对此单词发起一个限时小测试。
清除聊天记录：仅清空与该单词的对话UI，不影响学习数据。
对话区域：

左侧（AI好友）与右侧（用户）气泡对话。

AI气泡内的任何单词都可点击。点击后，在单词上方弹出一个小浮层，显示该点击单词的简明释义和词性。

底部输入栏：

左侧【+】按钮：展开扩展功能面板，包含：

【记忆技巧】：向AI好友请求“用你的方法帮我记住你”。

【造句】：请求“用我造个关于[旅行]的句子”（“[旅行]”为可点击编辑的占位符）。

【比较】：请求“你和‘vague’有什么区别？”

【手写】：进入全屏手写板，书写的内容会作为一张图片发送到聊天中。

中间文本输入框：可自由输入任何问题。

右侧【发送】按钮：发送文本消息。

页面四：白名单页面

布局：分为上下两部分。

上部 - 统计与概览：

显示“我的白名单词库”、“当前掌握平均分”、“连续打卡天数”。

一个【开始今日特训】按钮：点击后，系统从白名单中智能挑选3-5个单词，组合成一套混合题型（听力、选择、填空）的连续挑战。

下部 - 单词网格列表：

以卡片网格形式展示所有白名单单词。

每张卡片内容：

单词（大字体）

掌握度进度条

一枚勋章图标（铜/银/金）

卡片交互：

点击卡片：直接进入针对该单词的强化训练模式。

长按卡片：弹出菜单，可选择“移出白名单”或“查看详情”。

页面五：“我的”个人中心页面

布局：列表形式。

顶部个人信息区：头像、昵称、学习天数、掌握词汇总数。

功能列表：

学习数据：进入数据统计页，包含曲线图、热力图等。
我的词库管理：可批量导出、导入单词，查看学习历史。
会员与订阅：显示当前版本（基础/高级/旗舰），并有升级入口。
设置：
通知管理：开关“单词好友消息提醒”。
发音设置：选择英音/美音。
AI偏好：设置AI好友的对话风格（幽默/严谨/鼓励等）。
通用设置：清除缓存等。
反馈与帮助
核心流程串联示例
用户完整体验一个单词复习的流程：

用户在首页看到“Ambiguous”发来新消息。

点击该条目，进入启动与语音验证页，完成跟读和自觉测试。

进入单词私聊主页面，看到AI好友发来的复习问题（如一个选择题），在聊天中回答。

回答后，在首页对该单词右滑打勾，单词从首页暂时消失。

几天后，该单词根据算法再次出现在首页，重复步骤1-4，形成闭环。

若觉得该单词特别难，在私聊页点击右上角菜单，选择 【加入白名单】，之后可在白名单页面对其进行专项特训。